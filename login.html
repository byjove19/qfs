<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login - Quantum Financial System</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="css/main.css">
</head>
<body>
    <!-- Preloader -->
    <div id="preloader">
        <div class="loader">
            <span>Q</span>
            <span>F</span>
            <span>S</span>
        </div>
    </div>

    <!-- Login Section -->
    <section class="login__area section-py-120" style="background: var(--tg-color-dark);">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-lg-6">
                    <div class="login__wrapper">
                        <!-- Header -->
                        <div class="login__header text-center mb-50">
                            <div class="login__logo mb-30">
                                <a href="index.html" class="logo-text">QUANTUM FINANCIAL SYSTEM</a>
                            </div>
                            <h2 class="login__title">Welcome Back</h2>
                            <p class="login__subtitle">Sign in to your QFS account</p>
                        </div>

                        <!-- Login Form -->
                        <form class="login__form" id="loginForm">
                            <div class="form-grp mb-25">
                                <label for="email">Email Address</label>
                                <div class="input-grp">
                                    <i class="fas fa-envelope"></i>
                                    <input type="email" id="email" name="email" required placeholder="Enter your email">
                                </div>
                            </div>

                            <div class="form-grp mb-25">
                                <label for="password">Password</label>
                                <div class="input-grp">
                                    <i class="fas fa-lock"></i>
                                    <input type="password" id="password" name="password" required placeholder="Enter your password">
                                    <button type="button" class="password-toggle">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                </div>
                            </div>

                            <div class="login__options mb-30">
                                <label class="checkbox-grp">
                                    <input type="checkbox" id="rememberMe">
                                    <span class="checkmark"></span>
                                    Remember me
                                </label>
                                <a href="#forgot-password" class="forgot-password">Forgot Password?</a>
                            </div>

                            <button type="submit" class="tg-btn login__btn w-100 mb-30" id="loginBtn">
                                <span>Sign In <i class="fas fa-arrow-right"></i></span>
                            </button>

                            <div class="login__divider mb-30">
                                <span>or continue with</span>
                            </div>

                            <div class="login__social mb-30">
                                <button type="button" class="social-btn google-btn">
                                    <i class="fab fa-google"></i>
                                    Google
                                </button>
                                <button type="button" class="social-btn wallet-btn">
                                    <i class="fas fa-wallet"></i>
                                    Wallet
                                </button>
                            </div>

                            <div class="login__footer text-center">
                                <p>Don't have an account? <a href="#register" class="register-link">Sign up</a></p>
                            </div>
                        </form>

                        <!-- Register Form (Hidden) -->
                        <form class="register__form" id="registerForm" style="display: none;">
                            <div class="register__header text-center mb-50">
                                <h2 class="register__title">Create Account</h2>
                                <p class="register__subtitle">Join the Quantum Financial System</p>
                            </div>

                            <div class="form-grp mb-25">
                                <label for="fullName">Full Name</label>
                                <div class="input-grp">
                                    <i class="fas fa-user"></i>
                                    <input type="text" id="fullName" name="fullName" required placeholder="Enter your full name">
                                </div>
                            </div>

                            <div class="form-grp mb-25">
                                <label for="regEmail">Email Address</label>
                                <div class="input-grp">
                                    <i class="fas fa-envelope"></i>
                                    <input type="email" id="regEmail" name="email" required placeholder="Enter your email">
                                </div>
                            </div>

                            <div class="form-grp mb-25">
                                <label for="regPassword">Password</label>
                                <div class="input-grp">
                                    <i class="fas fa-lock"></i>
                                    <input type="password" id="regPassword" name="password" required placeholder="Create a password">
                                    <button type="button" class="password-toggle">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                </div>
                            </div>

                            <div class="form-grp mb-30">
                                <label for="confirmPassword">Confirm Password</label>
                                <div class="input-grp">
                                    <i class="fas fa-lock"></i>
                                    <input type="password" id="confirmPassword" name="confirmPassword" required placeholder="Confirm your password">
                                </div>
                            </div>

                            <div class="register__options mb-30">
                                <label class="checkbox-grp">
                                    <input type="checkbox" id="agreeTerms" required>
                                    <span class="checkmark"></span>
                                    I agree to the <a href="#terms">Terms of Service</a> and <a href="#privacy">Privacy Policy</a>
                                </label>
                            </div>

                            <button type="submit" class="tg-btn register__btn w-100 mb-30" id="registerBtn">
                                <span>Create Account <i class="fas fa-arrow-right"></i></span>
                            </button>

                            <div class="register__footer text-center">
                                <p>Already have an account? <a href="#login" class="login-link">Sign in</a></p>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Theme Toggle -->
    <div class="theme-toggle">
        <button class="theme-btn" id="themeToggle">
            <i class="fas fa-moon"></i>
        </button>
    </div>

    <!-- Notification Container -->
    <div class="notification-container" id="notificationContainer"></div>

    <script>
        // JavaScript will be added here
        document.addEventListener('DOMContentLoaded', function() {
            // Preloader
            window.addEventListener('load', function() {
                const preloader = document.getElementById('preloader');
                if (preloader) {
                    preloader.style.display = 'none';
                }
            });

            // Theme Toggle
            const themeToggle = document.getElementById('themeToggle');
            const themeIcon = themeToggle.querySelector('i');
            
            const savedTheme = localStorage.getItem('theme') || 'dark';
            document.documentElement.setAttribute('data-theme', savedTheme);
            updateThemeIcon(savedTheme);
            
            themeToggle.addEventListener('click', function() {
                const currentTheme = document.documentElement.getAttribute('data-theme');
                const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
                
                document.documentElement.setAttribute('data-theme', newTheme);
                localStorage.setItem('theme', newTheme);
                updateThemeIcon(newTheme);
            });
            
            function updateThemeIcon(theme) {
                themeIcon.className = theme === 'dark' ? 'fas fa-sun' : 'fas fa-moon';
            }

            // Password Toggle
            const passwordToggles = document.querySelectorAll('.password-toggle');
            passwordToggles.forEach(toggle => {
                toggle.addEventListener('click', function() {
                    const input = this.closest('.input-grp').querySelector('input');
                    const icon = this.querySelector('i');
                    
                    if (input.type === 'password') {
                        input.type = 'text';
                        icon.className = 'fas fa-eye-slash';
                    } else {
                        input.type = 'password';
                        icon.className = 'fas fa-eye';
                    }
                });
            });

            // Form Switching
            const registerLink = document.querySelector('.register-link');
            const loginLink = document.querySelector('.login-link');
            const loginForm = document.getElementById('loginForm');
            const registerForm = document.getElementById('registerForm');

            if (registerLink) {
                registerLink.addEventListener('click', function(e) {
                    e.preventDefault();
                    loginForm.style.display = 'none';
                    registerForm.style.display = 'block';
                });
            }

            if (loginLink) {
                loginLink.addEventListener('click', function(e) {
                    e.preventDefault();
                    registerForm.style.display = 'none';
                    loginForm.style.display = 'block';
                });
            }

            // Form Submission
            const loginBtn = document.getElementById('loginBtn');
            const registerBtn = document.getElementById('registerBtn');

            if (loginForm) {
                loginForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    handleLogin();
                });
            }

            if (registerForm) {
                registerForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    handleRegister();
                });
            }

            async function handleLogin() {
                const formData = new FormData(loginForm);
                const data = {
                    email: formData.get('email'),
                    password: formData.get('password')
                };
                
                setLoading(loginBtn, true);
                
                try {
                    const response = await fetch('/api/login', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(data)
                    });
                    
                    const result = await response.json();
                    
                    if (response.ok) {
                        showNotification('Login successful!', 'success');
                        setTimeout(() => {
                            window.location.href = '/dashboard';
                        }, 1000);
                    } else {
                        showNotification(result.message || 'Login failed', 'error');
                    }
                } catch (error) {
                    showNotification('Network error. Please try again.', 'error');
                    console.error('Login error:', error);
                } finally {
                    setLoading(loginBtn, false);
                }
            }

            async function handleRegister() {
                const formData = new FormData(registerForm);
                const password = formData.get('password');
                const confirmPassword = formData.get('confirmPassword');
                
                if (password !== confirmPassword) {
                    showNotification('Passwords do not match', 'error');
                    return;
                }
                
                if (!document.getElementById('agreeTerms').checked) {
                    showNotification('Please agree to the terms and conditions', 'warning');
                    return;
                }
                
                const data = {
                    fullName: formData.get('fullName'),
                    email: formData.get('email'),
                    password: password
                };
                
                setLoading(registerBtn, true);
                
                try {
                    const response = await fetch('/api/register', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(data)
                    });
                    
                    const result = await response.json();
                    
                    if (response.ok) {
                        showNotification('Registration successful! Please check your email for verification.', 'success');
                        setTimeout(() => {
                            registerForm.style.display = 'none';
                            loginForm.style.display = 'block';
                            registerForm.reset();
                        }, 2000);
                    } else {
                        showNotification(result.message || 'Registration failed', 'error');
                    }
                } catch (error) {
                    showNotification('Network error. Please try again.', 'error');
                    console.error('Registration error:', error);
                } finally {
                    setLoading(registerBtn, false);
                }
            }

            function setLoading(button, isLoading) {
                if (isLoading) {
                    button.classList.add('loading');
                    button.disabled = true;
                } else {
                    button.classList.remove('loading');
                    button.disabled = false;
                }
            }

            function showNotification(message, type = 'info') {
                const container = document.getElementById('notificationContainer');
                const notification = document.createElement('div');
                notification.className = `notification ${type}`;
                notification.textContent = message;
                
                container.appendChild(notification);
                
                setTimeout(() => {
                    notification.style.animation = 'slideInRight 0.3s ease-out reverse';
                    setTimeout(() => {
                        if (notification.parentNode) {
                            notification.parentNode.removeChild(notification);
                        }
                    }, 300);
                }, 5000);
            }
        });
    </script>
</body>
</html>